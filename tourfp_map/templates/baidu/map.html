<!DOCTYPE html>
<html>
	<head>

		<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>Using Baidu Map</title>
		<style type="text/css">
			html {
				height: 100%
			}

			body {
				height: 100%;
				margin: 0px;
				padding: 0px
			}

			#container {
				height: 100%
			}
		</style>
		{% load staticfiles %}
		<script src="{% static "jquery-2.1.1.min.js" %}" type="text/javascript"></script>
		<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=fci7iKfiurBcqTSeXEm0lGtw"></script>
		<!--  //此为v1.5版本的引用方式 //http://api.map.baidu.com/api?v=1.5&key=您的密钥&callback=initialize";//此为v1.4版本及以前版本的引用方式 -->
	</head>

	<body>
		<div id="container"></div>
		<script type="text/javascript">
			function getLineList(map) {
				$.ajax({
					type : "GET",
					url : "/get_line_list/",
					dataType : "json",
					success : function(json) {
						// window.alert(json[0]);
						
						// 1 解析JSON
						
						// 2 得到点列表
					}
				})
			}
		</script>
		<script type="text/javascript">
			var map = new BMap.Map("container");
			// 创建地图实例
			var spoint = new BMap.Point(116.404, 39.915);
			// 创建点坐标
			map.centerAndZoom(spoint, 10);
			// 初始化地图，设置中心点坐标和地图级别
			//		map.centerAndZoom(point, 15); // 初始化地图，设置中心点坐标和地图级别
			map.addControl(new BMap.NavigationControl());
			
			var route_arr = '{{route_list}}';

			var reg = new RegExp(/(&#39;)/g);
			route_arr = route_arr.replace(reg, "");
			route_arr = route_arr.substring(1, route_arr.length - 2).split(",");

			// window.alert (route_arr);
			// window.alert (route_arr.length);
			for (var i = 0; i<route_arr.length; i+=4 ){

				map.addOverlay(
					new BMap.Polyline([new BMap.Point(Number(route_arr[i]), Number(route_arr[i+1])), new BMap.Point(Number(route_arr[i+2]), Number(route_arr[i+3]))], {
					strokeColor : "blue",
					strokeWeight : 3,
					strokeOpacity : 0.5
					})
				);
			}

			//	drawCircle(new BMap.Point(109.404, 39.915));
			//drawCircle(new BMap.Point(109.404, 37.915));
			//var bjPoint = new BMap.Point(109.404, 39.915);
			//getPoint();
			//alert(bjPoint.lng);
			//alert(bjPoint.lat);
			//drawCircle(bjPoint);
			//drawLine(bjPoint, new BMap.Point(116.404, 39.915));
			//drawLine(new BMap.Point(126.404, 39.915), new BMap.Point(116.404, 39.915));

			var polyline1 = new BMap.Polyline([new BMap.Point(118.70718912023, 40.004529004226), new BMap.Point(118.18703339943, 39.636668880397)], {
				strokeColor : "blue",
				strokeWeight : 3,
				strokeOpacity : 0.5
			});
			map.addOverlay(polyline1);

			function initPoint() {
				var point = new BMap.Point(116.404, 39.915);
				map.centerAndZoom(point, 15);
				// 编写自定义函数，创建标注
			}

			function drawCircle(point) {
				//var point = new BMap.Point(116.404, 39.915);
				var circle = new BMap.Circle(point, 20000);

				map.addOverlay(circle);
			}

			function drawLine(start, end) {
				var polyline = new BMap.Polyline([start, end], {
					strokeColor : "blue",
					strokeWeight : 3,
					strokeOpacity : 0.5
				});
				map.addOverlay(polyline);
			}
		</script>
	</body>
</html>
